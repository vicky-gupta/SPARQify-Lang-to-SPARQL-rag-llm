Question 1: "For the patient with PatientID “P24680”, show their PatientSize and PatientWeight."

⟶ Raw SPARQL (from RAG):
SELECT ?PatientSize ?PatientWeight WHERE { ?study dcm:PatientID "P24680" . ?study dcm:PatientSize ?PatientSize . ?study dcm:PatientWeight ?PatientWeight . }

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 2: "Which studies UID have RetrieveAETitle equal to “CT_ARCHIVE_A”?"

⟶ Raw SPARQL (from RAG):
SELECT ?studyUID ?title WHERE { ?study rdf:type :Study . ?study dc:identifier ?studyUID . ?study dc:title ?title . FILTER REGEX(?title, "CT_ARCHIVE_A", "i") } LIMIT 10

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 3: "Find all seriesUID of images with modality CT performed by PerformingPhysiciansName “Dr. Johnson” between 08:00:00 and 12:00:00."

⟶ Raw SPARQL (from RAG):
SELECT ?seriesUID WHERE { ?s rdf:type :Study . ?s dcm:SeriesUID ?seriesUID . ?s dcm:Modality "CT" . ?s dcm:PerformingPhysiciansName "Dr. Johnson" . ?s dcm:AcquisitionDate xsd:dateTime "2008-04-08T08:00:00"^^xsd:dateTime . ?s dcm:AcquisitionDate xsd:dateTime "2008-04-08T12:00:00"^^xsd:dateTime . } LIMIT 1000

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 4: "Retrieve all CT images UID where KVP is greater than 120."

⟶ Raw SPARQL (from RAG):
SELECT ?imageUID ?kvp WHERE { ?image rdf:type :CTImage . ?image dcm:KVP ?kvp . FILTER(?kvp > "120") } LIMIT 100

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 5: "List the SOPInstanceUIDs of CT images acquired on 2023‑06‑15."

⟶ Raw SPARQL (from RAG):
SELECT ?sopInstanceUid WHERE { ?s a <http://semantic-dicom.org/dcm#CTImage> . ?s <http://semantic-dicom.org/dcm#AcquisitionDate> "2023-06-15"^^xsd:date . ?s <http://semantic-dicom.org/dcm#SOPInstanceUID> ?sopInstanceUid . } LIMIT 1000

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 6: "Find the UID of oldest CT image (by AcquisitionDate) for PatientName “Michael Brown.”"

⟶ Raw SPARQL (from RAG):
SELECT ?UID WHERE { ?image rdf:type dcm:Image . ?image dcm:PatientID ?patientID . ?image dcm:AcquisitionDate ?acquisitionDate . ?image dcm:PatientName "Michael Brown" . FILTER(?acquisitionDate = (MAX(?acquisitionDate) AS ?maxAcquisitionDate)) . ?image dcm:UID ?UID . } LIMIT 1

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 7: "Show PatientOrientation and PixelSpacing for all CT images in SeriesInstanceUID “S78901.”"

⟶ Raw SPARQL (from RAG):
SELECT ?orientation ?spacing WHERE { ?image rdf:type http://semantic-dicom.org/dcm#Image . ?image dcm:ImageOrientationPatient ?orientation . ?image dcm:PixelSpacing ?spacing . ?image dcm:series http://semantic-dicom.org/dcm#SeriesInstanceUID "S78901" . } LIMIT 10

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 8: "For each patient, compute the average PatientWeight across all their studies."

⟶ Raw SPARQL (from RAG):
SELECT ?patient ?averagePatientWeight
WHERE {
  ?study a dcm:Study .
  ?study dcm:hasPatient ?patient .
  ?study dcm:PatientWeight ?weight .
  { ?study2 a dcm:Study . ?study2 dcm:hasPatient ?patient . ?study2 dcm:PatientWeight ?weight2 . }
  OPTIONAL { ?study2 dcm:isSameAs ?study . }
  FILTER ( ?study != ?study2 ) .
  BIND( AVG(?weight) AS ?averagePatientWeight) .
}

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 9: "List every study instance UID where PatientsAge exceeds 65 years."

⟶ Raw SPARQL (from RAG):
SELECT ?studyInstanceUID WHERE { ?study rdf:type dcm:Study . ?study dcm:PatientsAge ?age . FILTER(?age > 65) . ?study dcm:hasStudyInstanceUID ?studyInstanceUID . } LIMIT 1000

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 10: "Show StudyDescription for studies dated between 2022‑01‑01 and 2022‑03‑31."

⟶ Raw SPARQL (from RAG):
SELECT ?studyDescription WHERE { ?study dcm:StudyDate ?date . FILTER (?date >= "2022-01-01"^^xsd:date && ?date <= "2022-03-31"^^xsd:date) . ?study dcm:StudyDescription ?studyDescription . } LIMIT 1000

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 11: "Retrieve the name of the patients whose PatientName starts with “P” and who have at least one CT image."

⟶ Raw SPARQL (from RAG):
SELECT ?name WHERE { ?patient http://semantic-dicom.org/dcm#PatientName ?name . ?patient http://semantic-dicom.org/dcm#PatientSex ?sex . ?patient http://semantic-dicom.org/dcm#Study ?study . ?study http://semantic-dicom.org/dcm#Modality "CT"^^xsd:string . FILTER (REGEX(?name, "^P", "i")) . FILTER(BOUND(?study)) }

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 12: "Find series UID where SeriesTime is between 14:00:00 and 16:00:00 on any date."

⟶ Raw SPARQL (from RAG):
SELECT ?seriesUID WHERE { ?series dcm:StudyInstanceUID ?seriesUID . ?series dcm:StudyTime "P14:00:00"^^xsd:time ."P16:00:00"^^xsd:time . }

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 13: "List patients names referred by Dr. Smith or Dr. Lee."

⟶ Raw SPARQL (from RAG):
SELECT ?patientName WHERE { ?patient rdf:type :Patient . ?patient :PatientName ?patientName . ?patient :ReferringPhysicianName "Dr. Smith" . } UNION { ?patient rdf:type :Patient . ?patient :PatientName ?patientName . ?patient :ReferringPhysicianName "Dr. Lee" . }

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 14: "For each patient name, show the total count of their CT images."

⟶ Raw SPARQL (from RAG):
SELECT ?patientName (COUNT(DISTINCT ?image) AS ?totalCount) WHERE { ?study rdf:type http://semantic-dicom.org/dcm#Study . ?study dcm:PatientName ?patientName . ?study dcm:Series ?series . ?series rdf:type http://semantic-dicom.org/dcm#CTImageSeries . ?series dcm:Image ?image . } GROUP BY ?patientName

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 15: "Retrieve studiesUID whose StudyDescription contains both the keywords “brain” and “contrast.”"

⟶ Raw SPARQL (from RAG):
SELECT ?studyInstanceUID WHERE { ?study dcm:StudyDescription ?description . ?study dcm:StudyInstanceUID ?studyInstanceUID . FILTER REGEX(?description, "brain") . FILTER REGEX(?description, "contrast") . } LIMIT 10

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 16: "List imagesUID where BitsStored is less than BitsAllocated."

⟶ Raw SPARQL (from RAG):
SELECT ?imagesUID WHERE { ?image rdf:type dcm:Image . ?image dcm:BitsAllocated ?bitsAllocated . ?image dcm:BitsStored ?bitsStored . FILTER(?bitsStored < ?bitsAllocated) }

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 17: "Retrieve the maximum RescaleSlope value across all CT images."

⟶ Raw SPARQL (from RAG):
SELECT ?maxRescaleSlope
WHERE {
  ?image rdf:type dcm:CTImage . 
  ?image dcm:RescaleSlope ?rescaleSlope . 
  FILTER(?rescaleSlope = (MAX(?image2) as xsd:float)) . 
  OPTIONAL { ?image dcm:RetrieveAETitle ?title . } 
} 
LIMIT 1

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 18: "Find patient names who have at least one series of Modality “CT” and at least one series of Modality “RTDOSE.”"

⟶ Raw SPARQL (from RAG):
SELECT ?name WHERE { ?study rdf:type :Study . ?study :PerformingPhysiciansName ?name . ?study :hasSeries ?series . FILTER(?series :Modality = "CT") . OPTIONAL { ?study :hasSeries ?series2 . FILTER(?series2 :Modality = "RTDOSE") } }

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 19: "Show all series UID where Modality is neither “CT” nor “MR.”"

⟶ Raw SPARQL (from RAG):
SELECT ?seriesUID WHERE { ?series rdf:type :Series . ?series dc:uid ?seriesUID . ?series http://semantic-dicom.org/dcm#Modality "CT"^^xsd:string . FILTER( !BOUND(?series http://semantic-dicom.org/dcm#Modality) ) . } UNION { SELECT ?seriesUID WHERE { ?series rdf:type :Series . ?series dc:uid ?seriesUID . ?series http://semantic-dicom.org/dcm#Modality "MR"^^xsd:string . FILTER( !BOUND(?series http://semantic-dicom.org/dcm#Modality) ) . } }

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 20: "List UID of CT images where RescaleIntercept is not set."

⟶ Raw SPARQL (from RAG):
SELECT ?uid WHERE { ?image rdf:type http://semantic-dicom.org/dcm#CTImage . ?image dcm:UID ?uid . FILTER (NOT EXISTS { ?image dcm:RescaleIntercept ?rescaleIntercept . }) } LIMIT 10

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 21: "For PatientName “Laura White,” show every StudyInstanceUID along with its StudyTime."

⟶ Raw SPARQL (from RAG):
SELECT ?studyInstanceUID ?studyTime WHERE { ?study rdf:type dcm:Study . ?study dcm:PatientName "Laura White" . ?study dcm:hasStudyInstanceUID ?studyInstanceUID . ?study dcm:StudyTime ?studyTime . } LIMIT 1000

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 22: "Retrieve CT images UID where PixelSpacing is between 0.5 and 1.5."

⟶ Raw SPARQL (from RAG):
SELECT ?imageUID ?pixelSpacing WHERE { ?image dcm:PixelSpacing ?pixelSpacing . ?image dcm:UID ?imageUID . FILTER(?pixelSpacing >= "0.5"^^xsd:float) FILTER(?pixelSpacing <= "1.5"^^xsd:float) } LIMIT 10

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 23: "List the number of studies for each PatientSex."

⟶ Raw SPARQL (from RAG):
SELECT ?PatientSex ?CountOfStudies
WHERE {
?study rdf:type dcm:Study . 
?study dcm:PatientSex ?PatientSex . 
} GROUP BY ?PatientSex
ORDER BY ?PatientSex
LIMIT 10

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 24: "Find UID of series created in the last 30 days (relative to 2025‑04‑20)."

⟶ Raw SPARQL (from RAG):
SELECT ?uid WHERE { ?series rdf:type dcm:Series . ?series dcm:SeriesDate ?date . FILTER(STRSTARTS(?date, "2025-03-20")) . ?series dcm:UID ?uid . } LIMIT 10

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 25: "List seriesUID that contain more than 50 CT images."

⟶ Raw SPARQL (from RAG):
SELECT ?seriesUID WHERE { ?series rdf:type :CTImageSeries . ?series rdfs:label ?seriesUID . COUNT(DISTINCT ?image) AS ?count . ?series http://semantic-dicom.org/dcm#containsImage ?image . FILTER(?count > 50) } LIMIT 100

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 26: "Retrieve studies UID before 2010‑01‑01 whose StudyID begins with “STU.”"

⟶ Raw SPARQL (from RAG):
SELECT ?study ?studyUID WHERE { ?study rdf:type dcm:Study . ?study dcm:StudyInstanceUID ?studyUID . ?study dcm:StudyTime "2010-01-01"^^xsd:date . FILTER REGEX(?study dcm:StudyID , "^STU.") } LIMIT 1000

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 27: "Find patients name older than 70 years with PatientWeight under 60 kg."

⟶ Raw SPARQL (from RAG):
SELECT ?name ?age ?weight WHERE { ?study rdf:type :Study . ?study :PatientWeight ?weight . ?study :PatientAge ?age . ?study :PatientName ?name . FILTER(?age > "70"^^xsd:integer) FILTER(?weight < "60"^^xsd:integer))} LIMIT 10000

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 28: "For each patient name, show their earliest and latest StudyDate."

⟶ Raw SPARQL (from RAG):
SELECT ?patientName ?earliestStudyDate ?latestStudyDate
WHERE {
  ?study dcm:StudyDate ?studyDate .
  ?study dcm:PatientID ?patientID .
  ?patient dcm:PatientID ?patientID .
  ?patient dcm:PatientName ?patientName .
  FILTER( REGEX(?patientName, "([^ ]+)", "i") ) .
  OPTIONAL { ?study dcm:StudyDate ?earliestStudyDate . }
  OPTIONAL { ?study dcm:StudyDate ?latestStudyDate . }
  BIND( MIN(?studyDate) AS ?earliestStudyDate ) .
  BIND( MAX(?studyDate) AS ?latestStudyDate ) .
} 
ORDER BY ?patientName ?earliestStudyDate ?latestStudyDate

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 29: "List studiesUID that are missing a RetrieveAETitle."

⟶ Raw SPARQL (from RAG):
SELECT ?studyID WHERE { ?study rdf:type :Study . ?study rdfs:subClassOf _:x . _:x owl:onProperty http://semantic-dicom.org/dcm#RetrieveAETitle . _:x owl:hasValue [] . ?study dc:identifier ?studyID . FILTER (NOT EXISTS { ?study http://semantic-dicom.org/dcm#RetrieveAETitle ?retrieveAETitle }) } LIMIT 10000

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 30: "Find all CT images UID where SamplesPerPixel > 1."

⟶ Raw SPARQL (from RAG):
SELECT ?imageUID WHERE { ?image rdf:type :CTImage . ?image owl:sameAs ?imageUID . ?image rdfs:label ?label . FILTER (?label = "CT") . ?image :SamplesPerPixel ?samplesPerPixel . FILTER(?samplesPerPixel > 1) } LIMIT 100

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 31: "Show each PatientName along with the total number of series they have."

⟶ Raw SPARQL (from RAG):
SELECT ?name ?count
WHERE {
?patient rdf:type :Patient . 
?patient :PatientName ?name . 
?series rdf:type :Series . 
?series :PerformingPhysiciansName ?physician . 
?series :Patient ?patient . 
} 
GROUP BY ?patient ?name
HAVING COUNT(?series) AS ?count
ORDER BY DESC(?count) }

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 32: "Retrieve studiesUID where StudyTime = “00:00:00” exactly."

⟶ Raw SPARQL (from RAG):
SELECT ?studyInstanceUID WHERE { ?study rdf:type :Study . ?study dc:studyInstanceUID ?studyInstanceUID . FILTER REGEX(?study dc:studyTime,"00:00:00", "i") } LIMIT 1000

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 33: "Find CT seriesUID whose ImageType includes the value “DERIVED.”"

⟶ Raw SPARQL (from RAG):
SELECT ?seriesUID WHERE { ?series rdf:type http://semantic-dicom.org/dcm#CTSeries . ?series dc:identifier ?seriesUID . ?image rdf:type http://semantic-dicom.org/dcm#Image . ?image http://semantic-dicom.org/dcm#ImageType "DERIVED" . } LIMIT 1000

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 34: "List all patients name whose PatientBirthDate falls on February 29 (leap day)."

⟶ Raw SPARQL (from RAG):
SELECT ?patientName ?PatientBirthDate WHERE { ?patient ?PatientBirthDate rdf:type http://semantic-dicom.org/dcm#PatientBirthDate . ?patient ?PatientBirthDate rdfs:label ?patientName . FILTER REGEX(?PatientBirthDate, "29-02") } LIMIT 1000

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 35: "Find images UID where HighBit is less than 12."

⟶ Raw SPARQL (from RAG):
SELECT ?imageUID WHERE { ?image rdf:type dcm:Image . ?image dcm:HighBit ?highBit . FILTER(?highBit < "12") . ?image dcm:isImageOf ?series . ?series dcm:UID ?imageUID . }

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 36: "List seriesUID where SeriesDate is in the summer months (June, July, or August)."

⟶ Raw SPARQL (from RAG):
SELECT ?seriesUID WHERE { ?series dcm:SeriesDate ?date . ?date dcm:inSummerMonths . ?series dcm:seriesUID ?seriesUID } FILTER (?seriesUID != "") .

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 37: "Retrieve patients names with PatientSize greater than 1.75 m."

⟶ Raw SPARQL (from RAG):
SELECT ?name ?size WHERE { ?study rdf:type http://semantic-dicom.org/dcm#Study . ?study http://semantic-dicom.org/dcm#PatientSize ?size . ?study http://semantic-dicom.org/dcm#ReferringPhysicianName ?name . FILTER(?size > "1.75") }

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 38: "Show seriesUID where PerformingPhysiciansName contains the substring “Watson.”"

⟶ Raw SPARQL (from RAG):
SELECT ?seriesUID WHERE { ?series rdf:type :PerfSeries . ?series dc:seriesUID ?seriesUID . ?series :PerformingPhysiciansName ?name . FILTER(STRINGSMATCH(?name, "Watson")) }

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 39: "List CT imagesUID where the Z‑coordinate of ImagePositionPatient is positive."

⟶ Raw SPARQL (from RAG):
SELECT ?imageUID WHERE { ?image dcm:is ?imageUID . ?image dcm:ImagePositionPatient [ dcm:ImagePositionPatient_z ?position ] . FILTER(?position > 0) } LIMIT 100

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 40: "What is the date difference between the earliest and latest study for Patient 'David Green'?"

⟶ Raw SPARQL (from RAG):
SELECT ?dateDiff
WHERE {
?study1 dcm:StudyDate ?earliestDate .
?study2 dcm:StudyDate ?latestDate .
?patient dcm:PatientID "David Green" .
?study1 dcm:Patient ?patient .
?study2 dcm:Patient ?patient .
FILTER (xsd:dateTime(?earliestDate) < xsd:dateTime(?latestDate)) .
BIND(STRDT(?latestDate - ?earliestDate) AS ?dateDiff)
}

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 41: "Find patientsName who have studies with a Patient Weight recorded but no Patient Size."

⟶ Raw SPARQL (from RAG):
SELECT ?patientsName WHERE { ?study rdf:type :Study . ?study dcm:PatientWeight ?weight . OPTIONAL { ?study dcm:PatientSize ?size } FILTER (isBlank(?size)) } UNION { ?study rdf:type :Study . ?study dcm:PatientWeight ?weight . ?study dcm:PatientName ?patientsName . FILTER (regex(?patientsName, "^[A-Za-z ]*$")) } }

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 42: "Retrieve the SOP Instance UIDs for images where the Acquisition Number is missing."

⟶ Raw SPARQL (from RAG):
SELECT ?sopInstanceUID WHERE { ?image rdf:type :Image . FILTER ( ISBLANK(?image http://semantic-dicom.org/dcm#AcquisitionNumber) ) . ?image http://semantic-dicom.org/dcm#SOPInstanceUID ?sopInstanceUID . } LIMIT 1000

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 43: "Calculate the minimum and maximum Rescale Intercept among all CT images"

⟶ Raw SPARQL (from RAG):
SELECT ?min ?max WHERE { MIN ?rescaleIntercept ( ?image ) . MAX ?rescaleIntercept ( ?image ) . } LIMIT 1

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 44: "What is the average Patient Weight for studies performed by Dr. Rodriguez?"

⟶ Raw SPARQL (from RAG):
SELECT ?averagePatientWeight WHERE { ?study rdf:type :Study . ?study dcm:PerformedBy <http://semantic-dicom.org/dcm#DrRodriguez> . ?study dcm:PatientWeight ?patientWeight . } GROUP BY ?patientWeight HAVING (COUNT(?patientWeight) AS ?count) * AVG(?patientWeight AS ?averagePatientWeight) FILTER (?count > 0) }

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 45: "What is the Bits Stored value for images with a Rescale Slope of 2.0?"

⟶ Raw SPARQL (from RAG):
SELECT ?image ?bitsStored WHERE { ?image rdf:type dcm:Image . ?image dcm:RescaleSlope "2.0"^^xsd:float . ?image dcm:BitsStored ?bitsStored . } LIMIT 1

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 46: "Find the Study Descriptions for all studies performed on October 26, 2022."

⟶ Raw SPARQL (from RAG):
SELECT ?studyDescription WHERE { ?study dcm:StudyDate "2022-10-26"^^xsd:date . ?study dcm:StudyDescription ?studyDescription . }

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 47: "What is the patient orientation for all CT images of patient Alex Thompson?"

⟶ Raw SPARQL (from RAG):
SELECT ?orientation 
WHERE { ?image rdf:type http://semantic-dicom.org/dcm#ImageOfCTImage . ?image dcm:ImageOrientationPatient ?orientation . ?image dcm:ImagePositionPatient ?position . ?image dcm:PatientName "Alex Thompson" . }

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 48: "List name of all patients who had studies referred by Dr. Chen but performed by Dr. Wang."

⟶ Raw SPARQL (from RAG):
SELECT ?patientName ?study
WHERE {
?study dcm:ReferringPhysicianName "Dr. Chen" .
?study dcm:PerformingPhysiciansName "Dr. Wang" .
?study dcm:PatientSize ?patient . 
FILTER regex(?patient,".*") .
BIND(STR(?patient) AS ?patientName) .
} LIMIT 10

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 49: "What is the range of energy weighting factors used in CT images for studies performed in 2023?"

⟶ Raw SPARQL (from RAG):
SELECT ?value WHERE { ?study rdf:type http://semantic-dicom.org/dcm#WaterEquivalentDiameterCalculationMethodCodeSequenceType . ?study dcm:StudyDate "2023"^^xsd:gYear . ?study dcm:EnergyWeightingFactor ?value . } LIMIT 1

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================


Question 50: "Which imagesUID have PhotometricInterpretation “MONOCHROME2” and SamplesPerPixel = 1?"

⟶ Raw SPARQL (from RAG):
SELECT ?image ?uid WHERE { ?image rdf:type dcm:Image . ?image dcm:PhotometricInterpretation "MONOCHROME2" . ?image dcm:SamplesPerPixel "1"^^xsd:integer . ?image dcm:SOPInstanceUID ?uid . } LIMIT 100

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:StudyDate
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyInstanceUID
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:StudyTime
  Domain(s): dcm:Study
  Range(s) : <class 'str'>

DataProperty: dcm:PatientBirthDate
  Domain(s): dcm
================================================================================



Question 1: "For the patient with PatientID “P24680”, show their PatientSize and PatientWeight."

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT ?PatientSize ?PatientWeight
WHERE {
  ?study dcm:PatientID "P24680" .
  ?study dcm:PatientSize ?PatientSize .
  ?study dcm:PatientWeight ?PatientWeight .
}

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 2: "Which studies UID have RetrieveAETitle equal to “CT_ARCHIVE_A”?"

⟶ Raw SPARQL (from RAG):
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX owl: <http://www.w3.org/2002/07/owl#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX dcm: <http://semantic-dicom.org/dcm#>

SELECT ?studyUID
WHERE {
  ?study rdf:type dcm:Study .
  ?study dcm:RetrieveAETitle "CT_ARCHIVE_A" .
  ?study dcm:StudyID ?studyUID .
}

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 3: "Find all seriesUID of images with modality CT performed by PerformingPhysiciansName “Dr. Johnson” between 08:00:00 and 12:00:00."

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT ?seriesUID
WHERE {
  ?study dcm:hasSeries ?series .
  ?series dcm:modality "CT" .
  ?series dcm:performingPhysiciansName "Dr. Johnson" .
  ?image dcm:isMemberOf ?series .
  ?image dcm:acquisitionTime ?time .
  FILTER(?time >= "2023-10-26T08:00:00")
  FILTER(?time <= "2023-10-26T12:00:00")
}

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 4: "Retrieve all CT images UID where KVP is greater than 120."

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT ?imageUID
WHERE {
  ?image a dcm:Image .
  ?image dcm:Modality "CT" .
  ?image dcm:KVP ?kvp .
  FILTER(?kvp > 120)
}

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 5: "List the SOPInstanceUIDs of CT images acquired on 2023‑06‑15."

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT ?SOPInstanceUID
WHERE {
  ?image dcm:Modality "CT" .
  ?image dcm:AcquisitionDate "2023-06-15"^^xsd:date .
  ?image dcm:SOPInstanceUID ?SOPInstanceUID .
}

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 6: "Find the UID of oldest CT image (by AcquisitionDate) for PatientName “Michael Brown.”"

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT ?imageUID
WHERE {
  ?patient dcm:PatientID "12345" .
  ?patient dcm:PatientName "Michael Brown" .
  ?image dcm:isImageOf ?patient .
  ?image dcm:AcquisitionDate ?acquisitionDate .
  FILTER(?acquisitionDate = (SELECT MIN(?date) WHERE { ?image2 dcm:AcquisitionDate ?date }) )
  ?image dcm:ImageUID ?imageUID .
}
LIMIT 1

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 7: "Show PatientOrientation and PixelSpacing for all CT images in SeriesInstanceUID “S78901.”"

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT ?patientOrientation ?pixelSpacing
WHERE {
  ?image dcm:SeriesInstanceUID "S78901" .
  ?image dcm:Modality "CT" .
  ?image dcm:ImageOrientationPatient ?patientOrientation .
  ?image dcm:PixelSpacing ?pixelSpacing .
}

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 8: "For each patient, compute the average PatientWeight across all their studies."

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT ?patient ?averageWeight
WHERE {
  ?study dcm:PatientWeight ?weight .
  ?study dcm:PatientsAge ?age .
  ?study dcm:PatientSize ?size .
  ?study dcm:isPartOf ?patient .
  BIND(AVG(?weight) AS ?averageWeight)
}
GROUP BY ?patient
ORDER BY ?averageWeight

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 9: "List every study instance UID where PatientsAge exceeds 65 years."

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT ?studyInstanceUID
WHERE {
  ?study dcm:PatientsAge ?age .
  FILTER(?age > 65)
  ?study dcm:StudyInstanceUID ?studyInstanceUID .
}

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 10: "Show StudyDescription for studies dated between 2022‑01‑01 and 2022‑03‑31."

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT ?studyDescription
WHERE {
  ?study dcm:StudyDate ?studyDate .
  FILTER(?studyDate >= "2022-01-01"^^xsd:date)
  FILTER(?studyDate <= "2022-03-31"^^xsd:date)
  ?study dcm:StudyDescription ?studyDescription .
}

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 11: "Retrieve the name of the patients whose PatientName starts with “P” and who have at least one CT image."

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT ?patientName
WHERE {
  ?patient dcm:PatientName ?patientName .
  FILTER(STRSTARTS(STR(?patientName), "P"))
  ?patient dcm:isPatientOf ?study .
  ?study dcm:hasModality "CT" .
}

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 12: "Find series UID where SeriesTime is between 14:00:00 and 16:00:00 on any date."

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT ?seriesUID
WHERE {
  ?series dcm:SeriesTime ?seriesTime .
  FILTER(?seriesTime >= "14:00:00"^^xsd:time)
  FILTER(?seriesTime <= "16:00:00"^^xsd:time)
  BIND(STR(?series rdf:type) AS ?seriesUID)
}

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 13: "List patients names referred by Dr. Smith or Dr. Lee."

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT ?patientName
WHERE {
  ?study dcm:ReferringPhysicianName "Dr. Smith" .
  ?study dcm:PatientName ?patientName .
  UNION
  {
    ?study dcm:ReferringPhysicianName "Dr. Lee" .
    ?study dcm:PatientName ?patientName .
  }
}

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 14: "For each patient name, show the total count of their CT images."

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT ?patientName (COUNT(?study) AS ?ctImageCount)
WHERE {
  ?study rdf:type dcm:Study .
  ?study dcm:PerformingPhysiciansName ?patientName .
  FILTER(REGEX(?patientName, "^[A-Z][a-z]+"))
}
GROUP BY ?patientName
ORDER BY DESC(?ctImageCount)

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 15: "Retrieve studiesUID whose StudyDescription contains both the keywords “brain” and “contrast.”"

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT ?studyUID
WHERE {
  ?study dcm:StudyDescription ?description .
  FILTER(CONTAINS(?description, "brain") && CONTAINS(?description, "contrast"))
  BIND(STR(?study) AS ?studyUID)
}

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 16: "List imagesUID where BitsStored is less than BitsAllocated."

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT ?imageUID
WHERE {
  ?image a dcm:Image .
  ?image dcm:BitsStored ?bitsStored .
  ?image dcm:BitsAllocated ?bitsAllocated .
  FILTER(?bitsStored < ?bitsAllocated)
}

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 17: "Retrieve the maximum RescaleSlope value across all CT images."

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT MAX(?rescaleSlope)
WHERE {
  ?image dcm:RescaleSlope ?rescaleSlope .
  ?image dcm:Modality "CT" .
}

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 18: "Find patient names who have at least one series of Modality “CT” and at least one series of Modality “RTDOSE.”"

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT DISTINCT ?patientName
WHERE {
  ?study dcm:Modality "CT" .
  ?study dcm:PatientName ?patientName .
  ?study2 dcm:Modality "RTDOSE" .
  ?study2 dcm:PatientName ?patientName .
}

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 19: "Show all series UID where Modality is neither “CT” nor “MR.”"

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT ?seriesUID
WHERE {
  ?series dcm:Modality ?modality .
  FILTER(?modality != "CT" && ?modality != "MR")
}

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 20: "List UID of CT images where RescaleIntercept is not set."

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT ?imageUID
WHERE {
  ?image dcm:Modality "CT" .
  ?image dcm:RescaleIntercept ?rescaleIntercept .
  FILTER (isBlank(?rescaleIntercept))
}

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 21: "For PatientName “Laura White,” show every StudyInstanceUID along with its StudyTime."

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT ?StudyInstanceUID ?StudyTime
WHERE {
  ?Study dcm:PatientName "Laura White" .
  ?Study dcm:StudyInstanceUID ?StudyInstanceUID .
  ?Study dcm:StudyTime ?StudyTime .
}

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 22: "Retrieve CT images UID where PixelSpacing is between 0.5 and 1.5."

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>

SELECT ?imageUID
WHERE {
  ?image dcm:PixelSpacing ?spacing .
  FILTER(?spacing >= 0.5 && ?spacing <= 1.5)
}

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 23: "List the number of studies for each PatientSex."

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT (COUNT(?study) AS ?studyCount) (DISTINCT ?sex)
WHERE {
  ?study dcm:StudyID ?id .
  ?study dcm:PatientsSex ?sex .
}
GROUP BY ?sex
ORDER BY DESC(?studyCount)

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 24: "Find UID of series created in the last 30 days (relative to 2025‑04‑20)."

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT ?seriesUID
WHERE {
  ?series dcm:SeriesDate ?seriesDate .
  FILTER(?seriesDate >= "2025-04-20"^^xsd:date)
  FILTER(?seriesDate <= DATE_SUB("2025-04-20"^^xsd:date, INTERVAL 30 DAY))
  ?series dcm:SeriesUID ?seriesUID .
}

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 25: "List seriesUID that contain more than 50 CT images."

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT ?seriesUID
WHERE {
  ?series dcm:Modality "CT" .
  ?series dcm:containsImage ?image .
  ?image dcm:isImageOf ?series .
  FILTER(COUNT(?image) > 50)
}
GROUP BY ?seriesUID

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 26: "Retrieve studies UID before 2010‑01‑01 whose StudyID begins with “STU.”"

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT ?studyInstanceUID ?studyID ?studyDate
WHERE {
  ?study dcm:StudyInstanceUID ?studyInstanceUID .
  ?study dcm:StudyID ?studyID .
  ?study dcm:StudyDate ?studyDate .
  FILTER(xsd:date(?studyDate) < xsd:date("2010-01-01"))
  FILTER(REGEX(?studyID, "^STU"))
}

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 27: "Find patients name older than 70 years with PatientWeight under 60 kg."

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT ?patientName ?patientsAge ?patientWeight
WHERE {
  ?study dcm:isStudyOf ?patient .
  ?patient dcm:PatientsName ?patientName .
  ?study dcm:PatientsAge ?patientsAge .
  ?study dcm:PatientWeight ?patientWeight .
  FILTER(?patientsAge > 70)
  FILTER(?patientWeight < 60)
}
ORDER BY ?patientName

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 28: "For each patient name, show their earliest and latest StudyDate."

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT ?patientName ?earliestStudyDate ?latestStudyDate
WHERE {
  ?study dcm:hasPatient ?patient .
  ?patient dcm:PatientName ?patientName .
  ?study dcm:StudyDate ?studyDate .
  FILTER(?studyDate >= (MIN(?studyDate) AS ?earliestStudyDate))
  FILTER(?studyDate <= (MAX(?studyDate) AS ?latestStudyDate))
}
GROUP BY ?patientName
ORDER BY ?patientName

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 29: "List studiesUID that are missing a RetrieveAETitle."

⟶ Raw SPARQL (from RAG):
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX owl: <http://www.w3.org/2002/07/owl#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX dcm: <http://semantic-dicom.org/dcm#>

SELECT ?studyUID
WHERE {
  ?study rdf:type dcm:Study .
  ?study dcm:StudyID ?studyID .
  OPTIONAL { ?study dcm:RetrieveAETitle ?retrieveAETitle . }
  FILTER (BOUND( ?retrieveAETitle ) == FALSE)
}

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 30: "Find all CT images UID where SamplesPerPixel > 1."

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT ?imageUID
WHERE {
  ?image dcm:Modality "CT" .
  ?image dcm:SOPInstanceUID ?imageUID .
  ?image dcm:SamplesPerPixel ?samples .
  FILTER(?samples > 1)
}

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 31: "Show each PatientName along with the total number of series they have."

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT ?PatientName (COUNT(?Series) AS ?SeriesCount)
WHERE {
  ?Patient dcm:PatientName ?PatientName .
  ?Patient dcm:PatientSex ?PatientSex .
  ?Series rdf:type dcm:Series .
  ?Series dcm:Patient ?Patient .
}
GROUP BY ?PatientName
ORDER BY ?PatientName

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 32: "Retrieve studiesUID where StudyTime = “00:00:00” exactly."

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT ?studyUID
WHERE {
  ?study a dcm:Study .
  ?study dcm:StudyTime "00:00:00"^^xsd:time .
}

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 33: "Find CT seriesUID whose ImageType includes the value “DERIVED.”"

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT ?seriesUID
WHERE {
  ?image dcm:isImageOf ?series .
  ?image dcm:ImageType "DERIVED" .
  ?series dcm:Modality "CT" .
}

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 34: "List all patients name whose PatientBirthDate falls on February 29 (leap day)."

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>

SELECT ?patientName
WHERE {
  ?patient dcm:PatientBirthDate ?birthDate .
  FILTER(REGEX(?birthDate, "^(\d{4})-02-29$", "i"))
}

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 35: "Find images UID where HighBit is less than 12."

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT ?imageUID
WHERE {
  ?image a dcm:Image .
  ?image dcm:HighBit ?highBit .
  FILTER(?highBit < 12)
}

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 36: "List seriesUID where SeriesDate is in the summer months (June, July, or August)."

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT ?seriesUID
WHERE {
  ?series dcm:SeriesDate ?seriesDate .
  FILTER(REGEX(?seriesDate, "Jun", "i") || REGEX(?seriesDate, "Jul", "i") || REGEX(?seriesDate, "Aug", "i"))
}

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 37: "Retrieve patients names with PatientSize greater than 1.75 m."

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT ?patientName
WHERE {
  ?study dcm:PatientSize ?size .
  FILTER(?size > "1.75")
  ?study dcm:PatientName ?patientName .
}

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 38: "Show seriesUID where PerformingPhysiciansName contains the substring “Watson.”"

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT ?seriesUID
WHERE {
  ?series dcm:PerformingPhysiciansName ?name .
  FILTER(CONTAINS(?name, "Watson"))
}

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 39: "List CT imagesUID where the Z‑coordinate of ImagePositionPatient is positive."

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT ?imageUID
WHERE {
  ?image rdf:type dcm:ImageOfCTImage .
  ?image dcm:ImagePositionPatient ?position .
  BIND(xsd:float(?z) AS ?z)
  FILTER(?z > 0)
}

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 40: "What is the date difference between the earliest and latest study for Patient 'David Green'?"

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT ?earliestDate ?latestDate (xsd:date(?latestDate) - xsd:date(?earliestDate)) AS ?dateDiff
WHERE {
  {
    ?study1 dcm:PatientID "David Green" .
    ?study1 dcm:StudyDate ?earliestDate .
  }
  {
    ?study2 dcm:PatientID "David Green" .
    ?study2 dcm:StudyDate ?latestDate .
  }
  FILTER(BOUND(?earliestDate) && BOUND(?latestDate))
  FILTER(?earliestDate <= ?latestDate)
}
ORDER BY ?dateDiff
LIMIT 1

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 41: "Find patientsName who have studies with a Patient Weight recorded but no Patient Size."

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT DISTINCT ?patientsName
WHERE {
  ?study dcm:hasPatient ?patient .
  ?patient dcm:patientsName ?patientsName .
  ?study dcm:PatientWeight ?weight .
  FILTER NOT EXISTS { ?study dcm:PatientSize ?size . }
}

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 42: "Retrieve the SOP Instance UIDs for images where the Acquisition Number is missing."

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT ?sopInstanceUID
WHERE {
  ?image a dcm:Image .
  MINUS { ?image dcm:AcquisitionNumber ?acquisitionNumber . }
  ?image dcm:SOPInstanceUID ?sopInstanceUID .
}

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 43: "Calculate the minimum and maximum Rescale Intercept among all CT images"

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT (MIN(?RescaleIntercept) AS ?minRescaleIntercept) (MAX(?RescaleIntercept) AS ?maxRescaleIntercept)
WHERE {
  ?image dcm:Modality "CT" .
  ?image dcm:RescaleIntercept ?RescaleIntercept .
}

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 44: "What is the average Patient Weight for studies performed by Dr. Rodriguez?"

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT (AVG(?patientWeight) AS ?averageWeight)
WHERE {
  ?study dcm:PatientWeight ?patientWeight .
  ?study dcm:PerformingPhysician "Dr. Rodriguez" .
}
GROUP BY ?performingPhysician
LIMIT 10

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 45: "What is the Bits Stored value for images with a Rescale Slope of 2.0?"

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT ?image ?bitsStored
WHERE {
  ?image a dcm:Image .
  ?image dcm:RescaleSlope "2.0"^^xsd:float .
  ?image dcm:BitsStored ?bitsStored .
}

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 46: "Find the Study Descriptions for all studies performed on October 26, 2022."

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT ?studyDescription
WHERE {
  ?study dcm:StudyDate "20221026" .
  ?study dcm:StudyDescription ?studyDescription .
}

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 47: "What is the patient orientation for all CT images of patient Alex Thompson?"

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT ?image ?patientOrientation
WHERE {
  ?image rdf:type dcm:ImageOfCTImage .
  ?image dcm:PatientOrientation ?patientOrientation .
  ?image dcm:PatientName "Alex Thompson" .
}

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 48: "List name of all patients who had studies referred by Dr. Chen but performed by Dr. Wang."

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT ?patientName
WHERE {
  ?study dcm:ReferringPhysicianName "Dr. Chen" .
  ?study dcm:PatientSize ?patientSize .
  ?series dcm:PerformingPhysiciansName "Dr. Wang" .
  ?study dcm:hasSeries ?series .
  ?patient dcm:hasStudy ?study .
  ?patient dcm:PatientName ?patientName .
}

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 49: "What is the range of energy weighting factors used in CT images for studies performed in 2023?"

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT ?energyWeightingFactorMin ?energyWeightingFactorMax
WHERE {
  ?image dcm:Modality "CT" .
  ?image dcm:EnergyWeightingFactor ?energyWeightingFactor .
  FILTER(?energyWeightingFactor >= ?energyWeightingFactorMin)
  FILTER(?energyWeightingFactor <= ?energyWeightingFactorMax)
}
GROUP BY ?energyWeightingFactorMin ?energyWeightingFactorMax
ORDER BY ASC(?energyWeightingFactorMin)
LIMIT 10

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


Question 50: "Which imagesUID have PhotometricInterpretation “MONOCHROME2” and SamplesPerPixel = 1?"

⟶ Raw SPARQL (from RAG):
PREFIX dcm: <http://semantic-dicom.org/dcm#>
SELECT ?imageUID
WHERE {
  ?image a dcm:Image .
  ?image dcm:PhotometricInterpretation "MONOCHROME2" .
  ?image dcm:SamplesPerPixel 1 .
  BIND(STR(?image dcm:SOPInstanceUID) AS ?imageUID)
}

⟶ Final SPARQL (after Ontology-based LLM Check):

You are an expert in SPARQL and OWL ontologies.

Given the following ontology references:
Class: dcm:Series
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isSeriesOf
    - onProperty: dcm:Modality
    - onProperty: dcm:PerformingPhysiciansName
    - onProperty: dcm:SeriesDate

Class: dcm:Image
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:AcquisitionDate
    - onProperty: dcm:AcquisitionNumber
    - onProperty: dcm:BitsAllocated
    - onProperty: dcm:BitsStored
    - onProperty: dcm:EnergyWeightingFactor
    - onProperty: dcm:HighBit
    - onProperty: dcm:ImageType
    - onProperty: dcm:KVP
    - onProperty: dcm:PatientOrientation
    - onProperty: dcm:PhotometricInterpretation
    - onProperty: dcm:RescaleIntercept
    - onProperty: dcm:RescaleSlope
    - onProperty: dcm:RescaleType
    - onProperty: dcm:SamplesPerPixel
    - onProperty: dcm:SOPClassUID
    - onProperty: dcm:SOPInstanceUID


Class: dcm:Study
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:isStudyOf
    - onProperty: dcm:PatientWeight
    - onProperty: dcm:PatientsAge
    - onProperty: dcm:PatientSize
    - onProperty: dcm:ReferringPhysicianName
    - onProperty: dcm:RetrieveAETitle
    - onProperty: dcm:StudyDate
    - onProperty: dcm:StudyID
    - onProperty: dcm:StudyInstanceUID
    - onProperty: dcm:StudyTime

Class: dcm:Patient
  Parents:
    - dcm:InformationEntity
  Restrictions:
    - onProperty: dcm:PatientBirthDate
    - onProperty: dcm:PatientID
    - onProperty: dcm:PatientName
    - onProperty: dcm:PatientSex


=== OBJECT PROPERTIES ===

ObjectProperty: dcm:containsImage
  Domain(s): dcm:Series
  Range(s) : dcm:Image

ObjectProperty: dcm:isSeriesOf
  Domain(s): dcm:Series
  Range(s) : dcm:Study

ObjectProperty: dcm:isImageOf
  Domain(s): dcm:Image
  Range(s) : dcm:Series

ObjectProperty: dcm:containsSeries
  Domain(s): dcm:Study
  Range(s) : dcm:Series

ObjectProperty: dcm:isStudyOf
  Domain(s): dcm:Study
  Range(s) : dcm:Patient

=== DATA PROPERTIES ===

DataProperty: dcm:ImagePositionPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageOrientationPatient
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionDate
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:AcquisitionNumber
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsAllocated
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:BitsStored
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:EnergyWeightingFactor
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:HighBit
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:ImageType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:KVP
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:PatientOrientation
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleIntercept
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleSlope
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:RescaleType
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SamplesPerPixel
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPClassUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:SOPInstanceUID
  Domain(s): dcm:Image
  Range(s) : <class 'str'>

DataProperty: dcm:Modality
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:PerformingPhysiciansName
  Domain(s): dcm:Series
  Range(s) : <class 'str'>

DataProperty: dcm:SeriesDate
  Domain
================================================================================


